---
title: "Hockey 2019 Stanley Cup Analysis"
author: "Nicholas Jacob"
date: "2/13/2020"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
df <- read.csv("https://raw.githubusercontent.com/nurfnick/Data_Sets_For_Stats/master/hockey.csv")
```

## The 2018-2019 Hockey Season

This was an exciting hockey season for me. My team home town team, St. Louis Blues, won Lord Stanley's Cup.  I wanted to examine the season and use the R programming language to do so.  I gathered my data from hockeyreference.com going to the Skaters tab and selecting basic stats.  I then took that data, created a csv file and uploaded that file to my github account.  I reference that data set here via direct link to read the csv into the programming language as a data frame.  Below is a sample of my data:

```{r}
df[1:10,]
```


There is a couple of interesting things we should point out right away.  We notice that Pontus Aberg is listed multiple times.  This is because he was traded during the season.  The stats from both teams have been recorded as well as his totals (signified by TOT).  We will need to be careful and deal with this before we proceed.  Let's first see how many payers there were in the season
```{r uniques}
players <- unique(df["Player"])

length(players$Player)

```
Looks like there were 906 unique players.  Next let's see how many were traded throughout the season.

```{r}
trades <- df[which(df$Tm=='TOT'),]
length(trades$Player)
```
Looks like 81 players played with multiple teams during the season.  I will just keep the data for the season and not for each of their individual teams that they played for.

```{r}
tradedplayers <- trades$Player
nottraded <- df[-which(df$Player %in% tradedplayers),]
df <- rbind(trades,nottraded)
df[1:10,1:10]
```
So now my data set just includes individual players with no duplicates.  Let's see if we can analize the varaibles. 
```{r}
summary(df)
```
So this output is very intense!  It went through every variable (and the case descriptors) and did some basic analysis of each.  I am interested in the plus/minus discrete quantitative variable but it is not named properly so let's fix that

```{r}
names(df)[names(df)=='X...'] <- 'PM'
```

## Categorical Variables

I want to examine the categorical variables for my project.  Let's recreate one of the frequency tables above and see if we can get relative frequency in it.

```{r}
options(digits=2)
freq <- rbind(table(df$Pos),table(df$Pos)/length(df$Pos))
row.names(freq)<-c('Frequency','Relative Frequency')
freq
```
Cool!  We see about 34% of the leagues skaters are centers and there are sigificantly more Left Wingers than right.

Next let's look at a two way table.
```{r}
table(df$Pos,df$Tm)
```
Not the most interesting table I have ever made but there are a few interesting aspects like Pittsburg Penguins and San Jose Sharks only had 1 left winger.  I have no idea why that might be the case, perhaps they are not "natural" left wingers but still play on that side and are therefore not counted.

##Quanitative Variables

I am going to examine the plus/minus of the players, I think it is one of the most acurate statistics of a player's overall effectiveness on the ice.  Below is the 5 number summary, the mean and standard deviation.
```{r plus/minus}
summary(df$PM)
sd(df$PM)
```
Now let's generate some graphics.  A histogram will show if the data is bell shaped and a box plot will help me look for outliers
```{r}
hist(df$PM)

```
```{r}
boxplot(df$PM, horizontal = TRUE, xlab = 'Plus/Minus')
```
Looks rather bell shaped but there are many outliers!  I want to see if I am truely normal so I will also examine the QQ Plot
```{r}
qqnorm(df$PM)
```
The data almost lies on the line so I will go with approximately normal.

For the side-by-side chart, I want to compare team plus/minus.  I will do this with box plots
```{r}
boxplot(df$PM ~ df$Tm, ylab ='Plus/Minus', xlab ="Teams")
```
The teams have been put in alphabetical order so it is hard to tell if there is a pattern but the number of outliers here is greatly reduced.

## Linear Regression

I like linear regression, so I will do it here even if it wasn't required anywhere for the project.
```{r}
plot(df$PM,df$G,xlab = 'Plus/Minus', ylab = 'Goals')
abline(lm(df$G~df$PM))
```
This plot is really boring, I want to spice it up a bit.  Let's see if I can get the teams in there too.
```{r}
ggplot(df,aes(x = PM, y = G, color=Tm))+
  geom_point()
```
So now each team is coloured.  For giggles, let's see what happens if we do a linear regression for each team.
```{r}
ggplot(df,aes(x = PM, y = G, color=Tm))+
  geom_point()+
  geom_smooth(method = "lm", se = FALSE)
```
Weirdly enough on some teams, scoring more goals will mean you have a worse plus/minus.  This seems counter intuitive but it might be a result of cutting the data up too much.

## Including Plots

You can also embed plots, for example:

```{r plus/minus, echo=FALSE}
hist(df$PM)
``` 

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
